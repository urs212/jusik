<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <title>주식 보유 현황 확인</title>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-app.js"></script>
    <script src="https://www.gstatic.com/firebasejs/8.10.1/firebase-database.js"></script>
    <style>
        body { background: #0b0e11; color: white; font-family: 'Pretendard', sans-serif; display: flex; flex-direction: column; align-items: center; justify-content: center; height: 100vh; margin: 0; }
        .login-box { background: #181a20; padding: 30px; border-radius: 15px; border: 1px solid #333; text-align: center; width: 350px; }
        input { width: 80%; padding: 12px; margin: 15px 0; border-radius: 8px; border: 1px solid #444; background: #2b2f36; color: white; text-align: center; font-size: 16px; }
        button { width: 88%; padding: 12px; border-radius: 8px; border: none; background: #02c076; color: white; font-weight: bold; cursor: pointer; font-size: 16px; }
        button:hover { background: #02a065; }
        
        .result-box { display: none; margin-top: 20px; width: 350px; background: #1e2329; padding: 20px; border-radius: 15px; border: 1px solid #02c076; }
        .stock-item { display: flex; justify-content: space-between; padding: 10px 0; border-bottom: 1px solid #333; }
        .stock-item:last-child { border-bottom: none; }
        .stock-name { color: #848e9c; }
        .stock-count { color: #f0b90b; font-weight: bold; }
        .error-msg { color: #f6465d; margin-top: 10px; font-size: 14px; display: none; }
    </style>
</head>
<body>

    <div class="login-box">
        <h2>내 주식 확인하기</h2>
        <p style="color: #848e9c; font-size: 14px;">마인크래프트 닉네임을 입력하세요</p>
        <input type="text" id="mcName" placeholder="닉네임 입력">
        <button onclick="checkStock()">조회하기</button>
        <div id="error" class="error-msg">해당 닉네임의 정보를 찾을 수 없습니다.</div>
    </div>

    <div id="result" class="result-box">
        <h3 id="display-name" style="text-align: center; margin-top: 0;"></h3>
        <div class="stock-item">
            <span class="stock-name">임승혁 (SH)</span>
            <span id="res-sh" class="stock-count">0</span>
        </div>
        <div class="stock-item">
            <span class="stock-name">중형주 (MID)</span>
            <span id="res-mid" class="stock-count">0</span>
        </div>
        <div class="stock-item">
            <span class="stock-name">코어 (CORE)</span>
            <span id="res-core" class="stock-count">0</span>
        </div>
        <div class="stock-item">
            <span class="stock-name">서버 (SERVER)</span>
            <span id="res-server" class="stock-count">0</span>
        </div>
    </div>

    <script>
        // 파이어베이스 설정 (본인의 정보로 유지됨)
        const firebaseConfig = {
            databaseURL: "https://midocre-a86a5-default-rtdb.firebaseio.com/"
        };
        firebase.initializeApp(firebaseConfig);
        const db = firebase.database();

        function checkStock() {
            const name = document.getElementById('mcName').value.trim();
            if (!name) return;

            // 데이터베이스에서 users/닉네임 경로 조회
            db.ref('users/' + name).once('value').then((snapshot) => {
                const data = snapshot.val();
                
                if (data) {
                    document.getElementById('error').style.display = 'none';
                    document.getElementById('result').style.display = 'block';
                    document.getElementById('display-name').innerText = name + "님의 자산";
                    
                    // 각 종목별 수량 표시 (데이터가 없으면 0으로 표시)
                    document.getElementById('res-sh').innerText = (data.sh || 0) + " 주";
                    document.getElementById('res-mid').innerText = (data.mid || 0) + " 주";
                    document.getElementById('res-core').innerText = (data.core || 0) + " 주";
                    document.getElementById('res-server').innerText = (data.server || 0) + " 주";
                } else {
                    document.getElementById('result').style.display = 'none';
                    document.getElementById('error').style.display = 'block';
                }
            }).catch((err) => {
                console.error(err);
                alert("데이터를 불러오는 중 오류가 발생했습니다.");
            });
        }
    </script>
</body>
</html>
